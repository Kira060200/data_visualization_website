---
title: "Proiect"
output: html_document
---

### Ex1

Presupunem ca avem un experiment aleator. Ne interesam la realizarea unui eveniment A, considerand ca sansa de realizare a lui A este p.
Aruncam o moneda cu probabilitatea de p (prob).

```{r ex1}
          
            prob = 0.33
            a = 0

            FctMasa = function(p){
                plot(c(1,0),c(p,1-p), lwd=5)
                segments(c(1,0), 0, c(1,0), c(p,1-p), col="red")
            }
            
     
            F = function(x,p){
                if (x<0){
                    y=0
                }else if (x<1){
                    y = 1-p
                }else{
                    y=1
                }
                return(y)
            }
            
            P = function(p, a, b=NULL, param=NULL)
            {
                if(is.null(b))
                {
                    if(is.null(param))
                    {
                        return(F(a, p))
                    }
                    else
                    {
                        return (1 - F(a, p))
                    }
                }
                else
                {
                    return (F(b, p) - F(a, p))
                }
            }
            
            fctMasa <- ({
                FctMasa(prob)
            })
            
            
            fctRep <- ({
                F2 = Vectorize(F, vectorize.args = "x")
                t2 = seq(-1,2,length.out = 1000)
                y2 = F2(t2,prob)
                plot(t2, y2, type= "l", col="red")
            })
            
            SelectProb = "P(x<=a)"
            
            
            fctProb <- ({
                
                F = Vectorize(F, vectorize.args = "x")
                t = seq(-1,2,length.out = 1000)
                y = F(t,prob)
                plot(t, y, type= "l", col="red")
                
                if(SelectProb=="P(x<=a)"){
                    x = seq(0,a)
                    y=F(x, prob)
              
                    
                    for(i in 1:length(x)){
                        tmp = 0
                        if(i==1)
                            tmp = 0
                        else
                            tmp = y[i-1]
                        lines(c(x[i],x[i]), c(tmp,y[i]), col="blue")
                    }
  
                }else if(SelectProb=="P(x>=b)"){
                    x = seq(b,2)
                    y = F(x,prob)
                    for(i in 1:length(x)){
                        tmp = 0
                        if(i==1)
                            tmp = 0
                        else
                            tmp = y[i-1]
                        lines(c(x[i],x[i]), c(tmp,y[i]), col="blue")
                    }
                }else{
                    x = seq(a,b)
                    y = F(x,prob)
                    for(i in 1:length(x)){
                        tmp = 0
                        if(i==1)
                            tmp = 0
                        else
                            tmp = y[i-1]
                        lines(c(x[i],x[i]), c(tmp,y[i]), col="blue")
                    }
                }
            
            })
                
            if(SelectProb=="P(x<=a)"){
                c("Probability: ", P(prob, a))
            }else if(SelectProb=="P(x>=b)"){
                c("Probability: ", P(prob, b, param = 1)+F(b, prob))
            }else{
                c("Probability: ", P(prob, a, b)+F(a, prob))
            }

```
## R Markdown

### Ex4

Presupunem ca un jucator de baseball are probabilitatea p (prob2) de a nimeri mingea.
Care este probabilitatea lui X <= 150 in n (NrAruncari) lovituri?


```{r ex4}

            prob2 = 0.33
            NrAruncari= 300
            a = 100
        

            fd4 = function(x)
            {
                return(dpois(x, prob2*NrAruncari , log = FALSE))
            }
            
            F4 = function(xx)
            {
                return (ppois(q = xx, lambda = NrAruncari*prob2, lower.tail = TRUE))
            }
            
            hits <- 0:NrAruncari 
            density <- fd4(hits)
            plot (x = hits,y=density,type="l")
         
            prob <- F4(hits)
            plot (x = hits,y=prob,type="l")
          
            x = 0:NrAruncari
            y = fd4(x)
            plot(x, y, type= "l", col="red")
                
            SelectProb = "P(x<=a)"
                
            if(SelectProb=="P(x<=a)"){
                 polygon(c(0,x[x<=a],a), c(0,y[x<=a],0), col="light blue")
            }else if(SelectProb=="P(x>=b)"){
                polygon(c(b,x[b<=x],NrAruncari),c(0,y[b<=x],0), col="light blue")
            }else{
                x = seq(a,b)
                y = fd4(x)
                polygon(c(a,x,b), c(0,y,0), col="light blue")
            }
         
          
            P4 = function(a, b=NULL, param=NULL)
            {
                if(is.null(b))
                {
                    if(is.null(param))
                    {
                        return(F4(a))
                    }
                    else
                    {
                        return (1 - F4 (a))
                    }
                }
                else
                {
                    return (F4(b) - F4(a))
                }
            }
            
            
            
            if(SelectProb=="P(x<=a)"){
                c("Probability: ", P4(a))
            }else if(SelectProb=="P(x>=b)"){
                c("Probability: ", P4(b, param = 1))
            }else{
                c("Probability: ", P4(a, b))
            }
        

```


## Including Plots

### Ex 5

Presupunem ca un medicament produce un efect secundar cu probabilitatea p (prob_infectare) . N (NrInfectati) pacienti primesc cate o doza.
Care este probabilitatea ca nicio persoana sa experimenteze efect advers?

```{r ex5}
          
            NrInfectati = 1000
            prob_infectare = 0.01
            b = 7
           

            fd5 = function(x)
            {
                return(dpois(x = x, lambda = NrInfectati * prob_infectare))
            }
            
            F5 = function(xx)
            {
                return (ppois(q = xx, lambda = NrInfectati * prob_infectare, lower.tail = TRUE))
            }
            
            fctMasa <- ({
                x <- 0:10
                density <- fd5(x)
                plot (x = x,y=density,type="l")
            })
            
            fctRep <- ({
                x <- 0:10
                prob <- F5(x)
                plot (x = x,y=prob,type="l")
            })
            
            SelectProb = "P(x>=b)"
            
            fctProb <- ({
                x = 0:10
                y = fd5(x)
                
                plot(x, y, type= "l", col="red")
                
                if(SelectProb=="P(x<=a)"){
                    polygon(c(0,x[x<=a],a), c(0,y[x<=a],0), col="light blue")
                }else if(SelectProb=="P(x>=b)"){
                    polygon(c(b,x[b<=x],NrInfectati),c(0,y[b<=x],0), col="light blue")
                }else{
                    x = seq(a,b)
                    y = fd5(x)
                    polygon(c(a,x,b), c(0,y,0), col="light blue")
                    
                }
            })
            
            P5 = function(a, b=NULL, param=NULL)
            {
                if(is.null(b))
                {
                    if(is.null(param))
                    {
                        return(F5(a))
                    }
                    else
                    {
                        return (1 - F5 (a))
                    }
                }
                else
                {
                    return (F5(b) - F5(a))
                }
            }
            
           
                
            if(SelectProb=="P(x<=a)"){
                c("Probability: ", P5(a))
            }else if(SelectProb=="P(x>=b)"){
                c("Probability: ", P5(b, param = 1))
            }else{
                c("Probability: ", P5(a, b))
            }
            

```

### Ex 8

Care este probabilitatea sa avem intre A si B vanzari daca vanzarea medie saptamanala este de E (exp_sales) ?

```{r ex8}

            # 8

            exp_sales = 3
            events = 10
            
            b = 4
            
            
            fd8 = function(x)
            {
                return(dpois(x = x, lambda = exp_sales))
            }
            
            F8 = function(xx)
            {
                return (ppois(q = xx, lambda = exp_sales, lower.tail = TRUE))
            }
            
            fctMasa <- ({
                ee = 0:events
                density <- fd8(ee)
                plot (x = ee,y=density,type="l")
            })
            
            fctRep <- ({
                e2 = 0:events
                prob <- ppois(q = e2, lambda = exp_sales, lower.tail = TRUE)
                plot (x = e2,y=prob,type="l")
            })
            
            SelectProb = "P(x>=b)"
            
            fctProb <- ({
                x = 0:events
                y = fd8(x)
                
                plot(x, y, type= "l", col="red")
                
                if(SelectProb=="P(x<=a)"){
                    polygon(c(0,x[x<=a],a), c(0,y[x<=a],0), col="light blue")
                }else if(SelectProb=="P(x>=b)"){
                    polygon(c(b,x[b<=x],NrInfectati),c(0,y[b<=x],0), col="light blue")
                }else{
                    x = seq(a,b)
                    y = fd8(x)
                    polygon(c(a,x,b), c(0,y,0), col="light blue")
                }
            })
            
            P8 = function(a, b=NULL, param=NULL)
            {
                if(is.null(b))
                {
                    if(is.null(param))
                    {
                        return(F8(a))
                    }
                    else
                    {
                        return (1 - F8 (a))
                    }
                }
                else
                {
                    return (F8(b) - F8(a))
                }
            }
            
            
            
            if(SelectProb=="P(x<=a)"){
                c("Probability: ", P8(a))
            }else if(SelectProb=="P(x>=b)"){
                c("Probability: ", P8(b, param = 1))
            }else{
                c("Probability: ", P8(a, b))
            
            }
        
            
```

### Ex 10 (Continua uniforma)

Selectarea a N (nr_test) numere intre A (lim_inf) si B (lim_sup) ?

```{r ex10}
            
            # 10

            nr_test = 10
            lim_inf = 1
            lim_sup = 3
            
            a = 2
            
            fd10 = function(x)
            {
                return(dunif(x = x, min=lim_inf,max=lim_sup))
            }
            
            F10 = function(xx)
            {
                return (punif(q = xx, min=lim_inf,max=lim_sup, lower.tail = TRUE))
            }
            
            
            fctMasa <- ({
                x = runif(nr_test, min = lim_inf, max = lim_sup)
                density <- fd10(x)
                plot (x = x,y=density,type="l")
            })
            
            fctRep <- ({
                x = runif(nr_test, min = lim_inf, max = lim_sup)
                prob <- F10(x)
                plot (x = x,y=prob,type="l")
            })
            
            SelectProb = "P(x<=a)"
            
            fctProb <-({
                x = seq(lim_inf , lim_sup)
                y = fd10(x)
                mini = min(y)
                plot(x, y, type= "l", col="red", ylim = c(0,1))
                if(SelectProb=="P(x<=a)"){
                    i <- x <= a
                    polygon(c(lim_inf,x[i],a), c(0,y[i],0), col="light blue")
                }else if(SelectProb=="P(x>=b)"){
                    i <- x >= b
                    polygon(c(b,x[i],lim_sup), c(0,y[i],0), col="light blue")
                }else{
                    
                    x = seq(a , b)
                    y = fd10(x)
                    
                    polygon(c(a,x,b), c(0,y,0), col="light blue")
                }
            })
            
            
            P10 = function(a, b=NULL, param=NULL)
            {
                if(is.null(b))
                {
                    if(is.null(param))
                    {
                        return(F10(a))
                    }
                    else
                    {
                        return (1 - F10 (a))
                    }
                }
                else
                {
                    return (F10(b) - F10(a))
                }
            }
            
            
            
            if(SelectProb=="P(x<=a)"){
                c("Probability: ", P10(a))
            }else if(SelectProb=="P(x>=b)"){
                c("Probability: ", P10(b, param = 1))
            }else{
                c("Probability: ", P10(a, b))
                
            }
    


```


### Ex13

Care e probabilitatea sa selectam x (ex13_x) bile rosii dintr-o multime cu k (ex13_k) extrase dintr-o urna care contine m (ex13_m) bile rosii si n (ex13_n) bile verzi? 

```{r ex13}

       
            ex13_x = 14
            ex13_m = 70
            ex13_n = 84
            ex13_k = 20

            a = 9
           
            fd13 = function(x)
            {
                return(dhyper(x = x, m = ex13_m, n = ex13_n, k = ex13_k))
            }
            
            F13 = function(xx)
            {
                return (phyper(q = xx, m = ex13_m, n = ex13_n, k = ex13_k, lower.tail = TRUE))
            }
            
            fctMasa <- ({
                x = seq(1:ex13_k)
                density <- fd13(x)
                plot (x = x,y=density,type="l")
            })
            
            fctRep <- ({
                x = seq(1:ex13_k)
                prob <- F13(x)
                plot (x = x,y=prob,type="l")
            })
            
            fctProb <-({
                x = seq(1:ex13_k)
                y = fd13(x)
                mini = min(y)
                plot(x, y, type= "l", col="red") # , ylim = c(0,1))
                if(SelectProb=="P(x<=a)"){
                    i <- x <= a
                    polygon(c(lim_inf,x[i],a), c(0,y[i],0), col="light blue")
                }else if(SelectProb=="P(x>=b)"){
                    i <- x >= b
                    polygon(c(b,x[i],lim_sup), c(0,y[i],0), col="light blue")
                }else{
                    x = seq(a , b)
                    y = fd13(x)
                    polygon(c(a,x,b), c(0,y,0), col="light blue")
                }
            })
            
            P13 = function(a, b=NULL, param=NULL)
            {
                if(is.null(b))
                {
                    if(is.null(param))
                    {
                        return(F13(a))
                    }
                    else
                    {
                        return (1 - F13 (a))
                    }
                }
                else
                {
                    return (F13(b) - F13(a))
                }
            }
            
            SelectProb = "P(x<=a)"
            
            if(SelectProb=="P(x<=a)"){
                c("Probability: ", P13(a))
            }else if(SelectProb=="P(x>=b)"){
                c("Probability: ", P13(b, param = 1))
            }else{
                c("Probability: ", P13(a, b))
            }


```

###
Consider an experiment with probability of success of p (ex21_p) and n (ex21_n) trials, i.e. X∼Bin(13,0.7).

```{r}
            # 21

            ex21_n = 13
            ex21_p = 0.7
            a = 8
            b = 11
    
            f21 = function(x){
                return(dbinom(x, size = ex21_n, prob = ex21_p))
            }
            
            F21 = function(xx){
                return(pbinom(xx, size = ex21_n, prob = ex21_p))
            }
            
            fctMasa <- ({
                x = 0:ex21_n
                density <- f21(x)
                plot (x = x,y=density,type="l")
            })
            
            fctRep <- ({
                x = 0:ex21_n
                prob <- F21(x)
                plot (x = x,y=prob,type="l")
            })
            
            SelectProb = "P(a<=x<=b)"
            
            fctProb <-({
                x = 0:ex21_n
                y = f21(x)
                mini = min(y)
                plot(x, y, type= "l", col="red") 
                
                if(SelectProb=="P(x<=a)"){
                    i <- x <= a
                    polygon(c(0,x[i],a), c(0,y[i],0), col="light blue")
                }else if(SelectProb=="P(x>=b)"){
                    i <- x >= b
                    polygon(c(b,x[i],max(x)), c(0,y[i],0), col="light blue")
                }else{
                    x = seq(a , b)
                    y = f21(x)
                    polygon(c(a,x,b), c(0,y,0), col="light blue")
                }
                
            })
            
            
            P21 = function(a, b=NULL, param=NULL)
            {
                if(is.null(b))
                {
                    if(is.null(param))
                    {
                        return(F21(a))
                    }
                    else
                    {
                        return (1 - F21 (a))
                    }
                }
                else
                {
                    return (F21(b) - F21(a))
                }
            }
            
            
              
            if(SelectProb=="P(x<=a)"){
                  c("Probability: ", P21(a))
            }else if(SelectProb=="P(x>=b)"){
                  c("Probability: ", P21(b, param = 1))
            }else{
                  c("Probability: ", P21(a, b))
            }
     
        

```


